
### Introduction

**What is Gobuster ?**

As the name implies,<mark style="background: #BBFABBA6;"> Gobuster is written in [Go](https://golang.org/). Go is an open-source, low-level language (much like C or Rust) developed by a team at Google and other contributors</mark>. If we'd like to learn more about Go, the website is linked above.

**Installing Gobuster on Kali Linux**
  
Luckily, installing Gobuster on Kali Linux does not require any installation of Go and does not carry with it a complicated install process. This means no building from source or running any other complicated commands.

```bash
sudo apt install gobuster
```

**Useful Global Flags**

There are some useful Global flags that can be used as well. I've included them in the table below. We can review these in the main documentation as well - [here](https://github.com/OJ/gobuster).

|Flag|Long Flag|Description|
|---|---|---|
|-t|--threads|Number of concurrent threads (default 10)|
|-v|--verbose|Verbose output|
|-z|--no-progress|Don't display progress|
|-q|--quiet|Don't print the banner and other noise|
|-o|--output|Output file to write results to|

<mark style="background: #FF5582A6;">We'll typically change the number of threads to 64 to increase the speed of the scans. If we don't change the number of threads, Gobuster can be a little slow</mark>.

### Gobuster Modes

**"dir" Mode**

Dirbuster has a "dir" mode that allows the user to enumerate website directories. This is useful when we're performing a penetration test and would like to see what the directory structure of a website is. Often, directory structures of websites and web-apps follow a certain convention, making them susceptible to brute-forcing using wordlists.

**Using "dir" Mode**

To use "dir" mode, we start by typing <mark style="background: #FF5582A6;">`gobuster dir`</mark>. This isn't the full command, but just the start. This tells Gobuster that we want to perform a directory search, instead of one of its other methods. It has to be written like this or else Gobuster will complain. After that, we'll need to add the URL and wordlist using the <mark style="background: #FF5582A6;">`-u`</mark> and <mark style="background: #FF5582A6;">`-w`</mark> options, respectively. Like so:

```bash
gobuster dir -u http://10.10.10.10 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```

Note: The URL is going to be the base path where Gobuster starts looking from. So the URL above is using the root web directory. For example, in a typical Apache installation on Linux, this is _/var/www/html_. So if we have a "products" directory and we want to enumerate that directory, you'd set the URL as _http://10.10.10.10/products_. We can also think of this like _http://example.com/path/to/folder_. Also <mark style="background: #FF5582A6;">notice that we specified the protocol of HTTP. This is important and required</mark>.

**Other Useful Flags**

These flags are useful in certain scenarios.  Note that these are not all of the flag options, but some of the more common ones that we'll use in penetration tests and in capture the flag events. If we'd like the full list, we can see that [here](https://github.com/OJ/gobuster#dir-mode-options).

|Flag|Long Flag|Description|
|---|---|---|
|-c|--cookies|Cookies to use for requests|
|-x|--extensions|File extension(s) to search for|
|-H|--headers|Specify HTTP headers, -H 'Header1: val1' -H 'Header2: val2'|
|-k|--no-tls-validation|Skip TLS certificate verification|
|-n|--no-status|Don't print status codes|
|-P|--password|Password for Basic Auth|
|-s|--status-codes|Positive status codes|
|-b|--status-codes-blacklist|Negative status codes|
|-U|--username|Username for Basic Auth|
  
A very common use of Gobuster's "dir" mode is the ability to use it's <mark style="background: #FF5582A6;">`-x`</mark> or<mark style="background: #FF5582A6;">`--extensions`</mark> flag to search for the contents of directories that we have already enumerated by providing a list of file extensions. File extensions are generally representative of the data they may contain. <mark style="background: #FF5582A6;">For example, "".conf" or "".config" files usually contain configurations for the application - including sensitive info such as database credentials</mark>.

A few other files that we may wish to search for are .txt files or other web application pages such as "".html" or "".php" . Let's assemble a command that would allow us to search the "myfolder" directory on a webserver for the following three files:

1. html

2. js

3. css

```bash
gobuster dir -u http://10.10.252.123/myfolder -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x.html,.css,.js
```

**The -k Flag**

The -k flag is special because it has an important use during penetration tests and captures the flag events, if HTTPS is enabled, we'll most likely encounter an invalid cert error like the one below

![](https://comodosslstore.com/resources/wp-content/uploads/2018/08/NET-ERR_CERT_DATE_INVALID.png)  

In instances like this, if we try to run Gobuster against this without the`-k` flag, it won't return anything and will most likely error out with something gross. an easy fix! Just adding the <mark style="background: #FF5582A6;">`-k`</mark> flag to our scan and it will bypass this invalid certification and continue scanning and deliver the goods! 

<mark style="background: #FF5582A6;">Note: This flag can be used with "dir" mode and "vhost" modes</mark>

**"dns" Mode**

the "dns" mode allows Gobuster to brute-force subdomains. During a penetration test (or capture the flag), it's important to check sub-domains of our target's top domain. <mark style="background: #FF5582A6;">Just because something is patched in the regular domain, does not mean it is patched in the sub-domain</mark>. There may be a vulnerability for us to exploit in one of these sub-domains. For example, if State Farm owns statefarm.com and mobile.statefarm.com, there may be a hole in mobile.statefarm.com that is not present in statefarm.com. This is why it is important to search for subdomains too!

**Using "dns" Mode

To use "dns" mode, we start by typing <mark style="background: #FF5582A6;">`gobuster dns`</mark>. Just like "dir" mode, this isn't the full command, but just the start. This tells Gobuster that we want to perform a sub-domain brute-force, instead of one of the other methods as previously mentioned. It has to be written like this or else Gobuster will complain. After that, we'll need to add the domain and wordlist using the -d and -w options, respectively. Like so:

```bash
gobuster dns -d mydomain.thm -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
```

This tells Gobuster to do a sub-domain scan on the domain "mydomain.thm". If there are any sub-domains available, Gobuster will find them and report them to us in the terminal.

**Other Useful Flags**

-d and -w are the main flags that we'll need for _most_ of our scans. But there are a few others that are worth mentioning that we can go over. They are in the table below.

|Flag|Long Flag|Description|
|---|---|---|
|-c|--show-cname|Show CNAME Records (cannot be used with '-i' option)|
|-i|--show-ips|Show IP Addresses|
|-r|--resolver|Use custom DNS server (format server.com or server.com:port)|

There aren't many additional flags to be used with this mode, but these are the main useful ones that we may use from time to time. If we'd like to see the full list of flags that can be used with this mode, we can check out the [documentation](https://github.com/OJ/gobuster#dns-mode-help)

**"vhost" Mode**

The last and final mode we'll focus on is the "vhost" mode. <mark style="background: #BBFABBA6;">This allows Gobuster to brute-force virtual hosts</mark>. Virtual hosts are different websites on the same machine. In some instances, they can appear to look like sub-domains, but don't be deceived! Virtual Hosts are IP based and are running on the same server. This is not usually apparent to the end-user. On an engagement, it may be worthwhile to just run Gobuster in this mode to see if it comes up with anything. We never know, it might just find something ! , virtual hosts would be a good way to hide a completely different website if nothing turned up on our main port 80/443 scan.

**Using "vhost" Mode**

To use "vhost" mode, we start by typing <mark style="background: #FF5582A6;">`gobuster vhost`</mark>. This tells Gobuster that we want to perform a virtual host brute-force, instead of one of the other methods as previously mentioned. It has to be written like this or else Gobuster will complain. After that, we'll need to add the domain and wordlist using the <mark style="background: #FF5582A6;">`-u`</mark> and <mark style="background: #FF5582A6;">`-w`</mark> options, respectively. Like so:

```bash
gobuster vhost -u http://example.com -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
```

This will tell Gobuster to do a virtual host scan [http://example.com](http://example.com/) using the selected wordlist.

### Useful Wordlists

**Kali Linux Default Lists**

Below we'll find a useful list of wordlists that are installed on Kali Linux by default. This is as of the latest version at the time of writing which is 2020.3. Anything with a wildcard (*) character indicates there's more than one list that matches. Keep in mind, a lot of these can be interchanged between modes. For example, "dir" mode wordlists (such as ones from the dirbuster directory) will contain words like "admin", "index", "about", "events", etc. A lot of these could be subdomains as well. Giving them a try with the different modes !

- /usr/share/wordlists/dirbuster/directory-list-2.3-*.txt
- /usr/share/wordlists/dirbuster/directory-list-1.0.txt
- /usr/share/wordlists/dirb/big.txt
- /usr/share/wordlists/dirb/common.txt
- /usr/share/wordlists/dirb/small.txt
- /usr/share/wordlists/dirb/extensions_common.txt - Useful for when fuzzing for files !

**Non-Standard Lists**

In addition to the above, Daniel Miessler has created an amazing GitHub repo called [SecLists](https://github.com/danielmiessler/SecLists). It compiles many different lists used for many different things. The best part is, it's in apt! We can <mark style="background: #FF5582A6;">`sudo apt install seclists`</mark> and get the entire repo !



