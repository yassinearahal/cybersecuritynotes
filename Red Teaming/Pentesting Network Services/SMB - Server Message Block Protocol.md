### Understanding:
The Server Message Block (SMB) protocol is a <mark style="background: #FF5582A6;">client-server communication protocol</mark> used for <mark style="background: #FF5582A6;">sharing files, printers, and other resources on a network</mark>. It provides a standardized method for accessing shared resources across different operating systems, it operates on port <mark style="background: #FF5582A6;">139 or 445</mark> by default SMB is widely used in both Windows and Linux environments, offering seamless file sharing and collaboration capabilities.

![[XMnru12.png]]

### Enumerating using:
**<mark style="background: #BBFABBA6;">Enum4Linux</mark>**
Enum4linux is a versatile open-source tool used to gather information from Windows and Samba systems. It helps identify vulnerabilities and weaknesses during security assessments. With features like user/group extraction and password policy retrieval, Enum4linux provides valuable insights, By examining file shares, weak passwords, and user privileges, it enhances network security.

The syntax of Enum4Linux is nice and simple: <mark style="background: #FF5582A6;">**"enum4linux [options] ip"**</mark>  
**Important Tags**
```bash
**TAG**            **FUNCTION**  

-U             get userlist  
-M             get machine list  
-N             get namelist dump (different from -U and-M)  
-S             get sharelist  
-P             get password policy information  
-G             get group and member list

-a             all of the above (full basic enumeration)
```

### Exploiting:
**Types of SMB Exploit** 
While there are vulnerabilities such as [CVE-2017-7494](https://www.cvedetails.com/cve/CVE-2017-7494/) that can allow remote code execution by exploiting SMB, we're more likely to encounter a situation where the best way into a system is due to misconfigurations in the system. In this case, we're going to be exploiting <mark style="background: #FF5582A6;">anonymous SMB share access</mark>- a common misconfiguration that can allow us to gain information that will lead to a shell.

**Method Breakdown**

So, from the enumeration stage, we should know:

    - The SMB share location

    - The name of an interesting SMB share

**SMBClient**

Because we're trying to access an SMB share, we need a client to access resources on servers. We will be using SMBClient because it's part of the default samba suite.

We can remotely access the SMB share using the syntax:
```bash
smbclient //[IP]/[SHARE]
```
**Important Tags**
```bash
# List the shares available on the server
smbclient -L <server>

# Connect to the server with a specific username
smbclient -U <username> //<server>/<share>

# Connect using a null password (no authentication)
smbclient -N //<server>/<share>

# Execute a command after connecting to the server
smbclient -c "<command>" //<server>/<share>

# Set the initial working directory on the server
smbclient -D <directory> //<server>/<share>

# Perform operations recursively on directories
smbclient -R //<server>/<share>

# Specify the password for user authentication
smbclient -P <password> //<server>/<share>
```