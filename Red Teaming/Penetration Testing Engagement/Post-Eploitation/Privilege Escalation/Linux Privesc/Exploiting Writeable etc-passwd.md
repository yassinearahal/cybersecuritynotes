##### **<mark style="background: #BBFABBA6;">Exploiting a Writable /etc/passwd File</mark>**

**<mark style="background: #FF5582A6;">Identification of Vulnerability</mark>:**

During the enumeration process, it was discovered that user7 has write permissions on the `/etc/passwd` file. Additionally, user7 is a member of the root group (GID 0). This combination of factors implies that user7 can edit the `/etc/passwd` file.

**<mark style="background: #FF5582A6;">Understanding /etc/passwd</mark>:**

The `/etc/passwd` file is a crucial system file in Linux that stores user account information required during login. It contains entries for each user, detailing information such as the username, UID (User ID), GID (Group ID), home directory, shell, and more. Entries are formatted as follows:

```
test:x:0:0:root:/root:/bin/bash
```

- **<mark style="background: #FF5582A6;">Fields</mark>:**
  - Username
  - Password (encrypted or indicated by "x")
  - UID (User ID)
  - GID (Group ID)
  - User ID Info (comment field)
  - Home Directory
  - Command/Shell

**<mark style="background: #FF5582A6;">Exploiting a Writable /etc/passwd</mark>:**

1. **Identify Writable Status:**
   - Confirm that the `/etc/passwd` file is writable for user7.

2. **Understanding File Format:**
   - Acknowledge the format of the `/etc/passwd` file, understanding the fields and their significance.

3. **Create a New Entry:**
   - Craft a new line entry for the user, adhering to the format.
   - Example:
     ```
     hacker:$1$abc$def:0:0:hacked:/root:/bin/bash
     ```

     - **Explanation:**
       - **Username:** hacker
       - **Password:** $1$abc$def (placeholder, could be an encrypted password)
       - **UID:** 0 (root)
       - **GID:** 0 (root)
       - **User ID Info:** hacked
       - **Home Directory:** /root
       - **Shell:** /bin/bash

4. **Add Entry to /etc/passwd:**
   - Append the crafted entry to the `/etc/passwd` file.

5. **Access with Root Privileges:**
   - With the new entry added, the user can now potentially log in as the created root user.

**<mark style="background: #FF5582A6;">Note</mark>:**
- The password field can be populated with an encrypted password or set to "x," indicating that the password hash is stored in the `/etc/shadow` file.

**<mark style="background: #FF5582A6;">Security Implications</mark>:**
- Allowing unauthorized write access to the `/etc/passwd` file poses a significant security risk, as it can lead to the creation of unauthorized users with elevated privileges.

**<mark style="background: #FF5582A6;">Mitigation</mark>:**
- Restrict write access to the `/etc/passwd` file to prevent unauthorized modifications.
- Regularly audit and monitor file permissions to identify and address security vulnerabilities promptly.

**Exploiting a writable `/etc/passwd` file poses severe security risks by enabling the unauthorized creation of root-level users. Ensuring proper file permissions and access controls is essential for maintaining the integrity and security of Linux systems.**